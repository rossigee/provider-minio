---
apiVersion: kuttl.dev/v1beta1
kind: TestAssert
---
apiVersion: minio.crossplane.io/v1
kind: User
metadata:
  name: sa-parent-user
status:
  atProvider:
    userName: sa-parent-user
    status: enabled
  conditions:
    - status: 'True'
    - status: 'True'
---
apiVersion: minio.crossplane.io/v1
kind: ServiceAccount
metadata:
  name: test-serviceaccount
spec:
  forProvider:
    parentUser: sa-parent-user
    serviceAccountName: test-sa
    policies:
      - readwrite
    description: "E2E test service account"
  providerConfigRef:
    name: provider-config
  writeConnectionSecretToRef:
    name: test-serviceaccount-creds
    namespace: default
status:
  atProvider:
    serviceAccountName: test-sa
    parentUser: sa-parent-user
  conditions:
    - status: 'True'
    - status: 'True'
---
apiVersion: v1
kind: Secret
metadata:
  name: test-serviceaccount-creds
  namespace: default
type: connection.crossplane.io/v1alpha1
data:
  accessKey: dGVzdC1zYQ==
---
apiVersion: v1
kind: Secret
metadata:
  name: sa-parent-user
  namespace: default
type: connection.crossplane.io/v1alpha1